volumes:
  ui:

services:
  backend:
    build:
      context: ./services/backend/
      dockerfile: ./Dockerfile
    command: ros2 launch cart_launch autonomous_launcher.launch.py #can be overriden with $BACKEND_COMMAND
    environment:
      - BACKEND_COMMAND #will override the default command above
      - $HOME/.ssh:/root/.ssh
      - $HOME/.gitconfig:/root/.gitconfig
      - DISPLAY
      - AMENT_PREFIX_PATH=/opt/ros/humble:/dev_ws/install:/dependency_ws/install
      - COLCON_PREFIX_PATH=/dev_ws/install
      - LD_LIBRARY_PATH=/usr/local/lib:/opt/ros/humble/lib:/dev_ws/install/lib:/dependency_ws/install/lib
    volumes:
      - $HOME/.Xauthority:/root/.Xauthority
      - /home/jacart2/LIO-SAM/dev_ws:/dev_ws
      - /tmp/.X11-unix:/tmp/.X11-unix
      - /dev:/dev
    privileged: true
    runtime: nvidia
    network_mode: "host"
  frontend:
    build:
      context: ./services/frontend/
      dockerfile: ./Dockerfile
    command: npm run dev #can be overriden with $FRONTEND_COMMAND
    environment:
      - FRONTEND_COMMAND #will override the default command above
    network_mode: "host"
    volumes:
      - $HOME/.ssh:/root/.ssh
      - $HOME/.gitconfig:/root/.gitconfig
      - ui:/ui
